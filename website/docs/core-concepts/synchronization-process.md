---
sidebar_position: 2
---

# Synchronization Process

The synchronization process is split into two main commands:

- `diff`: This command performs a comparison between the local JSON files generated by `pull` and the current state of a Directus instance. It outlines the elements that need to be created, updated, or deleted to achieve synchronization.

- `push`: This command executes the actual synchronization plan, applying the necessary changes to the Directus instance. It handles dependencies and circular dependencies carefully by potentially running the synchronization process multiple times until the Directus instance is fully in sync with the JSON definitions.

## Command Lifecycle

### Pull Command

```mermaid
flowchart TB
    Start[Start Pull] --> Config[Load Configuration]
    Config --> Client[Initialize Client]
    Client --> Collections[For Each Collection]
    Collections --> Query[Build Query]
    Query --> |onQuery| QueryHook[Query Hook]
    QueryHook --> Fetch[Fetch Elements]
    Fetch --> |onDump| DumpHook[Dump Hook]
    DumpHook --> Process[Process Elements]
    Process --> |onSave| SaveHook[Save Hook]
    SaveHook --> Store[Store to Files]
    Store --> Schema[Handle Schema]
    Schema --> |onSave| SchemaHook[Schema Save Hook]
    SchemaHook --> End[End Pull]
```

### Diff Command

```mermaid
flowchart TB
    Start[Start Diff] --> Config[Load Configuration]
    Config --> Local[Load Local Files]
    Local --> |onLoad| LoadHook[Load Hook]
    LoadHook --> Remote[Get Remote State]
    Remote --> Schema[Compare Schema]
    Schema --> |onLoad| SchemaHook[Schema Load Hook]
    SchemaHook --> Compare[Compare Elements]
    Compare --> Report[Generate Report]
    Report --> End[End Diff]
```

### Push Command

```mermaid
flowchart TB
    Start[Start Push] --> Config[Load Configuration]
    Config --> Local[Load Local Files]
    Local --> |onLoad| LoadHook[Load Hook]
    LoadHook --> Remote[Get Remote State]
    Remote --> Plan[Plan Changes]
    Plan --> Execute[Execute Changes]
    Execute --> Retry{Retry Needed?}
    Retry --> |Yes| Execute
    Retry --> |No| End[End Push]
```
