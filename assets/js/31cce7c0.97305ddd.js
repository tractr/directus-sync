"use strict";(self.webpackChunkwebsite=self.webpackChunkwebsite||[]).push([[2432,6416,8352],{223:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>a,contentTitle:()=>o,default:()=>p,frontMatter:()=>l,metadata:()=>i,toc:()=>h});const i=JSON.parse('{"id":"features/seed","title":"Seed Data","description":"Directus Sync allows you to manage seed data for your collections. This data is used to populate your Directus instance with custom data.","source":"@site/docs/features/seed.mdx","sourceDirName":"features","slug":"/features/seed","permalink":"/directus-sync/docs/features/seed","draft":false,"unlisted":false,"editUrl":"https://github.com/directus-sync/directus-sync/tree/main/website/docs/features/seed.mdx","tags":[],"version":"current","sidebarPosition":2,"frontMatter":{"sidebar_position":2},"sidebar":"docs","previous":{"title":"Synchronization","permalink":"/directus-sync/docs/features/synchronization"},"next":{"title":"Configuration","permalink":"/directus-sync/docs/features/configuration"}}');var t=s(2540),r=s(3023),c=s(767),d=s(1275);const l={sidebar_position:2},o="Seed Data",a={},h=[{value:"Commands",id:"commands",level:2},{value:"Seed Diff",id:"seed-diff",level:3},...c.toc,{value:"Seed Push",id:"seed-push",level:3},...d.toc,{value:"Seed Structure",id:"seed-structure",level:2},{value:"Basic Structure",id:"basic-structure",level:3},{value:"Meta Options",id:"meta-options",level:3},{value:"Files Organization",id:"files-organization",level:3},{value:"Examples",id:"examples",level:2},{value:"Basic Collection",id:"basic-collection",level:3},{value:"Collection with Relations",id:"collection-with-relations",level:3},{value:"Directus Users",id:"directus-users",level:3},{value:"Directus Files",id:"directus-files",level:3},{value:"Many-to-Many Relations",id:"many-to-many-relations",level:3},{value:"Best Practices",id:"best-practices",level:2}];function u(e){const n={a:"a",admonition:"admonition",code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,r.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.header,{children:(0,t.jsx)(n.h1,{id:"seed-data",children:"Seed Data"})}),"\n",(0,t.jsx)(n.p,{children:"Directus Sync allows you to manage seed data for your collections. This data is used to populate your Directus instance with custom data."}),"\n",(0,t.jsx)(n.p,{children:"The seed process is different from the synchronization process.\nIt is more flexible but not plug and play as the synchronization process. It requires more configurations."}),"\n",(0,t.jsxs)(n.p,{children:["The main difference with the synchronization process is that the seed data are not pulled from the Directus instance.\nYou have to create the seed data manually. Seed data must be written in JSON format and must be placed in the ",(0,t.jsx)(n.code,{children:"./directus-config/seed"})," directory (this can be changed using the ",(0,t.jsx)(n.code,{children:"--seed-path"})," option).\nAny file in this directory will be automatically detected and used by the ",(0,t.jsx)(n.code,{children:"seed diff"})," and ",(0,t.jsx)(n.code,{children:"seed push"})," commands."]}),"\n",(0,t.jsx)(n.p,{children:"As for the synchronization process, the seed data are tracked. Therefore if any change is made to the seed data, it will be updated in the Directus instance. Also, if a seed data is deleted, it will be removed from the Directus instance."}),"\n",(0,t.jsx)(n.admonition,{type:"important",children:(0,t.jsxs)(n.p,{children:["The seed commands require the schema to be synchronized first. Make sure to run ",(0,t.jsx)(n.code,{children:"npx directus-sync push"})," before running any seed commands."]})}),"\n",(0,t.jsx)(n.h2,{id:"commands",children:"Commands"}),"\n",(0,t.jsx)(n.h3,{id:"seed-diff",children:"Seed Diff"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"npx directus-sync seed diff\n"})}),"\n",(0,t.jsx)(n.p,{children:"Shows differences between local seed data and Directus instance:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Identifies new items to create"}),"\n",(0,t.jsx)(n.li,{children:"Shows modifications to existing items"}),"\n",(0,t.jsx)(n.li,{children:"Lists items to be deleted"}),"\n",(0,t.jsx)(n.li,{children:"Non-destructive operation"}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Available Options"})}),"\n",(0,t.jsx)(c.default,{}),"\n",(0,t.jsx)(n.h3,{id:"seed-push",children:"Seed Push"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"npx directus-sync seed push\n"})}),"\n",(0,t.jsx)(n.p,{children:"Applies seed data changes to your Directus instance:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Creates new items"}),"\n",(0,t.jsx)(n.li,{children:"Updates existing items"}),"\n",(0,t.jsx)(n.li,{children:"Removes tracked items not in seed files"}),"\n",(0,t.jsx)(n.li,{children:"Maintains relationships"}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Available Options"})}),"\n",(0,t.jsx)(d.default,{}),"\n",(0,t.jsx)(n.h2,{id:"seed-structure",children:"Seed Structure"}),"\n",(0,t.jsx)(n.h3,{id:"basic-structure",children:"Basic Structure"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-json",children:'{\n    "collection": "collection_name",\n    "meta": {\n        "insert_order": 1,\n        "create": true,\n        "update": true,\n        "delete": true,\n        "preserve_ids": false,\n        "ignore_on_update": []\n    },\n    "data": [\n        {\n            "_sync_id": "unique-identifier",\n            "field1": "value1",\n            "field2": "value2"\n        }\n    ]\n}\n'})}),"\n",(0,t.jsx)(n.h3,{id:"meta-options",children:"Meta Options"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"insert_order"}),": Order of insertion (for dependencies)"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"create"}),": Whether to create new items"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"update"}),": Whether to update existing items"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"delete"}),": Whether to delete missing items"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"preserve_ids"}),": Whether to keep original IDs"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"ignore_on_update"}),": Fields to ignore during updates"]}),"\n"]}),"\n",(0,t.jsx)(n.admonition,{type:"warning",children:(0,t.jsxs)(n.p,{children:["When using ",(0,t.jsx)(n.code,{children:"preserve_ids: true"}),", make sure that the ",(0,t.jsx)(n.code,{children:"_sync_id"})," field contains a valid ID that matches the collection's primary key type.\nFor example, if your collection uses UUID as primary key, the ",(0,t.jsx)(n.code,{children:"_sync_id"})," must be a valid UUID."]})}),"\n",(0,t.jsx)(n.h3,{id:"files-organization",children:"Files Organization"}),"\n",(0,t.jsxs)(n.p,{children:["You can have multiple seed files in the ",(0,t.jsx)(n.code,{children:"seed"})," directory.\nEach may contain one collection (as shown in the examples above) or multiple collections."]}),"\n",(0,t.jsx)(n.p,{children:"In case of multiple collections in a single file, the content of the JSON should be an array of collections :"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-json",children:'[\n    {\n        "collection": "collection_1",\n        "meta": {},\n        "data": []\n    },\n    {\n        "collection": "collection_2",\n        "meta": {},\n        "data": []\n    }\n]\n'})}),"\n",(0,t.jsx)(n.admonition,{type:"note",children:(0,t.jsxs)(n.p,{children:["If there is many seeds for the same collection, those seeds will be merged.\nThe ",(0,t.jsx)(n.code,{children:"meta"})," values are merged and the lowest ",(0,t.jsx)(n.code,{children:"insert_order"})," is used."]})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"directus-config/\n\u2514\u2500\u2500 seed/\n    \u251c\u2500\u2500 categories.json\n    \u2514\u2500\u2500 articles.json\n"})}),"\n",(0,t.jsx)(n.h2,{id:"examples",children:"Examples"}),"\n",(0,t.jsx)(n.h3,{id:"basic-collection",children:"Basic Collection"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-json",children:'{\n    "collection": "categories",\n    "meta": {\n        "insert_order": 1\n    },\n    "data": [\n        {\n            "_sync_id": "category-tech",\n            "name": "Technology",\n            "slug": "tech",\n            "status": "published"\n        },\n        {\n            "_sync_id": "category-science",\n            "name": "Science",\n            "slug": "science",\n            "status": "published"\n        }\n    ]\n}\n'})}),"\n",(0,t.jsx)(n.h3,{id:"collection-with-relations",children:"Collection with Relations"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-json",children:'{\n    "collection": "articles",\n    "meta": {\n        "insert_order": 2\n    },\n    "data": [\n        {\n            "_sync_id": "article-1",\n            "title": "Future of AI",\n            "category": "category-tech",\n            "status": "published"\n        }\n    ]\n}\n'})}),"\n",(0,t.jsxs)(n.p,{children:["Note how the ",(0,t.jsx)(n.code,{children:"category"})," field references the ",(0,t.jsx)(n.code,{children:"_sync_id"})," of items in the categories collection."]}),"\n",(0,t.jsx)(n.admonition,{type:"note",children:(0,t.jsxs)(n.p,{children:["The relations between collections are automatically inferred from the schema snapshot of Directus.\nThis means that the schema snapshot must be pushed first by running ",(0,t.jsx)(n.code,{children:"npx directus-sync push"}),"."]})}),"\n",(0,t.jsx)(n.h3,{id:"directus-users",children:"Directus Users"}),"\n",(0,t.jsxs)(n.p,{children:["This is an example of a seed file for the ",(0,t.jsx)(n.code,{children:"directus_users"})," collection:"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-json",children:'{\n    "collection": "directus_users",\n    "meta": {\n        "insert_order": 1\n    },\n    "data": [\n        {\n            "_sync_id": "user-1",\n            "first_name": "John",\n            "last_name": "Doe",\n            "email": "john.doe@example.com",\n            "role": "_sync_default_admin_role"\n        },\n        {\n            "_sync_id": "user-2",\n            "first_name": "Jane",\n            "last_name": "Smith",\n            "email": "jane.smith@example.com",\n            "password": "password"\n        }\n    ]\n}\n'})}),"\n",(0,t.jsxs)(n.p,{children:["The ",(0,t.jsx)(n.code,{children:"role"})," field references the the sync id of the role. You can find it in the file ",(0,t.jsx)(n.code,{children:"directus-config/collections/roles.json"}),"."]}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.code,{children:"password"})," field is automatically ignored during update. This is to prevent the password from being reset on every push."]}),"\n",(0,t.jsxs)(n.p,{children:["The ",(0,t.jsx)(n.code,{children:"directus_roles"})," collection is not managed by the ",(0,t.jsx)(n.code,{children:"seed push"})," but by the ",(0,t.jsx)(n.code,{children:"pull"})," and ",(0,t.jsx)(n.code,{children:"push"})," commands."]}),"\n",(0,t.jsx)(n.admonition,{type:"warning",children:(0,t.jsxs)(n.p,{children:["The seed of the ",(0,t.jsx)(n.code,{children:"directus_users"})," collection is experimental and may change in the future."]})}),"\n",(0,t.jsx)(n.h3,{id:"directus-files",children:"Directus Files"}),"\n",(0,t.jsxs)(n.p,{children:["This is an example of a seed file for the ",(0,t.jsx)(n.code,{children:"directus_files"})," collection:"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-json",children:'{\n    "collection": "directus_files",\n    "meta": {\n        "insert_order": 2\n    },\n    "data": [\n        {\n            "_sync_id": "file-1",\n            "_file_path": "./logo.jpg",\n            "storage": "local",\n            "filename_download": "the-file-1.jpg",\n            "title": "File 1",\n            "tags": ["tag-1", "tag-2"],\n            "description": "File 1 description",\n            "folder": "92d60c0c-30b8-49d9-bd63-11008fa652af",\n            "uploaded_by": "user-1",\n            "metadata": { "test": "value" }\n        },\n        {\n            "_sync_id": "file-2",\n            "_file_path": "./logo.jpg",\n            "storage": "local",\n            "filename_download": "the-file-2.jpg",\n            "title": "File 2",\n            "tags": ["tag-2", "tag-3"],\n            "description": "File 2 description",\n            "metadata": { "test": "value-2" }\n        }\n    ]\n}\n'})}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Notes:"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.code,{children:"_file_path"}),": path to the local file to upload. Use a relative path from the seed file location or an absolute path. The file must exist."]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.code,{children:"uploaded_by"})," (",(0,t.jsx)(n.em,{children:"optional"}),"): reference a user by that user's seed ",(0,t.jsx)(n.code,{children:"_sync_id"})," (e.g., ",(0,t.jsx)(n.code,{children:'"user-1"'})," from your ",(0,t.jsx)(n.code,{children:"directus_users"})," seed). Ensure insert order respects dependencies: create users before files (e.g., ",(0,t.jsx)(n.code,{children:"directus_users"})," with ",(0,t.jsx)(n.code,{children:"insert_order: 1"}),", ",(0,t.jsx)(n.code,{children:"directus_files"})," with ",(0,t.jsx)(n.code,{children:"insert_order: 2"}),")"]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.code,{children:"folder"})," (",(0,t.jsx)(n.em,{children:"optional"}),"): reference a folder by its ",(0,t.jsx)(n.code,{children:"_syncId"})," as defined in ",(0,t.jsx)(n.code,{children:"collections/folders.json"})," (system collections dump)."]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:["Available properties are listed in the ",(0,t.jsx)(n.a,{href:"https://directus.io/docs/api/files#upload-a-file",children:"Directus documentation"}),"."]}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"many-to-many-relations",children:"Many-to-Many Relations"}),"\n",(0,t.jsx)(n.p,{children:"Many-to-many relations have to be handled manually.\nYou need to create data in the junction collection in order to create the relation."}),"\n",(0,t.jsxs)(n.p,{children:["For example, if you want to create a many-to-many relation between the ",(0,t.jsx)(n.code,{children:"articles"})," and ",(0,t.jsx)(n.code,{children:"tags"})," collections, you need to create data in the ",(0,t.jsx)(n.code,{children:"articles_tags"})," junction collection."]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-json",children:'{\n    "collection": "articles_tags",\n    "meta": {},\n    "data": [\n        {\n            "_sync_id": "article-tag-1",\n            "tag": "tag-1",\n            "article": "article-1"\n        },\n        {\n            "_sync_id": "article-tag-2",\n            "tag": "tag-2",\n            "article": "article-1"\n        }\n    ]\n}\n'})}),"\n",(0,t.jsx)(n.h2,{id:"best-practices",children:"Best Practices"}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Insert Order"}),": Set the ",(0,t.jsx)(n.code,{children:"insert_order"})," carefully to ensure dependencies are created in the correct order. Collections with no dependencies should have lower numbers."]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Sync IDs"}),":"]}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["Use meaningful and consistent naming for ",(0,t.jsx)(n.code,{children:"_sync_id"})]}),"\n",(0,t.jsxs)(n.li,{children:["Prefix them with the collection name (e.g., ",(0,t.jsx)(n.code,{children:"country-usa"}),", ",(0,t.jsx)(n.code,{children:"city-paris"}),")"]}),"\n",(0,t.jsx)(n.li,{children:"Keep them unique across your seed data"}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Relations"}),":"]}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["Use the ",(0,t.jsx)(n.code,{children:"_sync_id"})," of related items to establish relationships"]}),"\n",(0,t.jsx)(n.li,{children:"Ensure related items exist in their respective seed files"}),"\n",(0,t.jsx)(n.li,{children:"Make sure the insert order respects these relationships"}),"\n"]}),"\n"]}),"\n"]})]})}function p(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(u,{...e})}):u(e)}},767:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>l,contentTitle:()=>d,default:()=>h,frontMatter:()=>c,metadata:()=>i,toc:()=>o});const i=JSON.parse('{"id":"help-outputs/seed-diff","title":"seed-diff","description":"","source":"@site/docs/help-outputs/seed-diff.md","sourceDirName":"help-outputs","slug":"/help-outputs/seed-diff","permalink":"/directus-sync/docs/help-outputs/seed-diff","draft":false,"unlisted":false,"editUrl":"https://github.com/directus-sync/directus-sync/tree/main/website/docs/help-outputs/seed-diff.md","tags":[],"version":"current","frontMatter":{}}');var t=s(2540),r=s(3023);const c={},d=void 0,l={},o=[];function a(e){const n={code:"code",pre:"pre",...(0,r.R)(),...e.components};return(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-text",children:'Options:\n  --seed-path <seedPath...>  the base path(s) for the seed (default\n                             "./directus-config/seed")\n  -h, --help                 display help for command\n'})})}function h(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(a,{...e})}):a(e)}},1275:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>l,contentTitle:()=>d,default:()=>h,frontMatter:()=>c,metadata:()=>i,toc:()=>o});const i=JSON.parse('{"id":"help-outputs/seed-push","title":"seed-push","description":"","source":"@site/docs/help-outputs/seed-push.md","sourceDirName":"help-outputs","slug":"/help-outputs/seed-push","permalink":"/directus-sync/docs/help-outputs/seed-push","draft":false,"unlisted":false,"editUrl":"https://github.com/directus-sync/directus-sync/tree/main/website/docs/help-outputs/seed-push.md","tags":[],"version":"current","frontMatter":{}}');var t=s(2540),r=s(3023);const c={},d=void 0,l={},o=[];function a(e){const n={code:"code",pre:"pre",...(0,r.R)(),...e.components};return(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-text",children:'Options:\n  --seed-path <seedPath...>            the base path(s) for the seed (default\n                                       "./directus-config/seed")\n  --max-push-retries <maxPushRetries>  the number of retries for the push\n                                       operation (default "20")\n  -h, --help                           display help for command\n'})})}function h(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(a,{...e})}):a(e)}},3023:(e,n,s)=>{s.d(n,{R:()=>c,x:()=>d});var i=s(3696);const t={},r=i.createContext(t);function c(e){const n=i.useContext(r);return i.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function d(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:c(e.components),i.createElement(r.Provider,{value:n},e.children)}}}]);