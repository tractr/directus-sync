"use strict";(self.webpackChunkwebsite=self.webpackChunkwebsite||[]).push([[53],{2563:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>a,contentTitle:()=>c,default:()=>h,frontMatter:()=>o,metadata:()=>i,toc:()=>d});const i=JSON.parse('{"id":"how-it-works/id-mapping","title":"Ids Mapping and Tracking","description":"directus-sync operates on a tagging system similar to Terraform, where each trackable element within Directus is assigned a unique synchronization identifier (SyncID). This system is key to enabling version control for the configurations and schema within Directus.","source":"@site/docs/how-it-works/id-mapping.md","sourceDirName":"how-it-works","slug":"/how-it-works/id-mapping","permalink":"/docs/how-it-works/id-mapping","draft":false,"unlisted":false,"editUrl":"https://github.com/directus-sync/directus-sync/tree/main/website/docs/how-it-works/id-mapping.md","tags":[],"version":"current","sidebarPosition":1,"frontMatter":{"sidebar_position":1},"sidebar":"docs","previous":{"title":"Helpers","permalink":"/docs/features/helpers"},"next":{"title":"Synchronization Process","permalink":"/docs/how-it-works/synchronization-process"}}');var t=s(4848),r=s(3023);const o={sidebar_position:1},c="Ids Mapping and Tracking",a={},d=[{value:"Process",id:"process",level:2},{value:"Mapping Table",id:"mapping-table",level:2},{value:"Tracked Elements",id:"tracked-elements",level:2},{value:"Roles &amp; Policies",id:"roles--policies",level:3},{value:"Presets",id:"presets",level:3},{value:"Non-Tracked Elements and Ignored Fields",id:"non-tracked-elements-and-ignored-fields",level:3},{value:"Strengths of <code>directus-sync</code>",id:"strengths-of-directus-sync",level:2}];function l(e){const n={admonition:"admonition",br:"br",code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",ol:"ol",p:"p",ul:"ul",...(0,r.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.header,{children:(0,t.jsx)(n.h1,{id:"ids-mapping-and-tracking",children:"Ids Mapping and Tracking"})}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.code,{children:"directus-sync"})," operates on a tagging system similar to Terraform, where each trackable element within Directus is assigned a unique synchronization identifier (SyncID). This system is key to enabling version control for the configurations and schema within Directus."]}),"\n",(0,t.jsx)(n.h2,{id:"process",children:"Process"}),"\n",(0,t.jsxs)(n.p,{children:["Upon execution of the ",(0,t.jsx)(n.code,{children:"pull"})," command, ",(0,t.jsx)(n.code,{children:"directus-sync"})," will:"]}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsx)(n.li,{children:"Scan the specified Directus collections, which include dashboards, flows, folders, operations, panels, permissions, policies, presets, roles, settings and translations."}),"\n",(0,t.jsx)(n.li,{children:"Assign a SyncID to each element within these collections if it doesn't already have one."}),"\n",(0,t.jsx)(n.li,{children:"Commit the data of these collections into code, allowing for versioning and tracking of configuration changes."}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:"This SyncID tagging facilitates the replication of configurations across different instances of Directus while maintaining the integrity and links between different entities."}),"\n",(0,t.jsx)(n.admonition,{type:"note",children:(0,t.jsxs)(n.p,{children:["The original IDs of the flows are preserved to maintain the URLs of the ",(0,t.jsx)(n.code,{children:"webhook"})," type flows.\nThe original IDs of the folders are preserved to maintain the associations with fields of the ",(0,t.jsx)(n.code,{children:"file"})," and ",(0,t.jsx)(n.code,{children:"image"})," types."]})}),"\n",(0,t.jsx)(n.admonition,{type:"tip",children:(0,t.jsxs)(n.p,{children:["You can use the ",(0,t.jsx)(n.code,{children:"--preserve-ids"})," option to preserve the original ids of some collections.\nEligible collections are collections using UUID: ",(0,t.jsx)(n.code,{children:"dashboards"}),", ",(0,t.jsx)(n.code,{children:"operations"}),", ",(0,t.jsx)(n.code,{children:"panels"}),", ",(0,t.jsx)(n.code,{children:"policies"}),", ",(0,t.jsx)(n.code,{children:"roles"})," and ",(0,t.jsx)(n.code,{children:"translations"}),".\nIf you have already used the ",(0,t.jsx)(n.code,{children:"pull"})," command, you may use the ",(0,t.jsx)(n.code,{children:"untrack"})," helper to remove the id tracking of an element before using this option."]})}),"\n",(0,t.jsx)(n.h2,{id:"mapping-table",children:"Mapping Table"}),"\n",(0,t.jsxs)(n.p,{children:["Since it's not possible to add tags directly to entities within Directus, ",(0,t.jsx)(n.code,{children:"directus-sync"})," uses a mapping table that correlates the SyncIDs with the internal IDs used by Directus. This mapping is essential for the synchronization process, as it ensures that each element can be accurately identified and updated across different environments."]}),"\n",(0,t.jsxs)(n.p,{children:["This is the main reason why ",(0,t.jsx)(n.code,{children:"directus-sync"})," needs the ",(0,t.jsx)(n.code,{children:"directus-extension-sync"})," extension to be installed on the Directus instances you want to synchronize."]}),"\n",(0,t.jsx)(n.h2,{id:"tracked-elements",children:"Tracked Elements"}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.code,{children:"directus-sync"})," tracks the following Directus collections:"]}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"dashboards"}),"\n",(0,t.jsx)(n.li,{children:"flows"}),"\n",(0,t.jsx)(n.li,{children:"folders"}),"\n",(0,t.jsx)(n.li,{children:"operations"}),"\n",(0,t.jsx)(n.li,{children:"panels"}),"\n",(0,t.jsx)(n.li,{children:"permissions"}),"\n",(0,t.jsx)(n.li,{children:"policies"}),"\n",(0,t.jsx)(n.li,{children:"presets"}),"\n",(0,t.jsx)(n.li,{children:"roles"}),"\n",(0,t.jsx)(n.li,{children:"settings"}),"\n",(0,t.jsx)(n.li,{children:"translations"}),"\n"]}),"\n",(0,t.jsxs)(n.p,{children:["For these collections, data changes are committed to the code, allowing for replication on other Directus instances. A\nmapping table links Directus instance IDs with SyncIDs, managed by the ",(0,t.jsx)(n.code,{children:"directus-extension-sync"}),"."]}),"\n",(0,t.jsx)(n.h3,{id:"roles--policies",children:"Roles & Policies"}),"\n",(0,t.jsxs)(n.p,{children:["Roles and policies are tracked.",(0,t.jsx)(n.br,{}),"\n","By default, Directus creates a default administrator role and two default policies: ",(0,t.jsx)(n.em,{children:"admin"})," and ",(0,t.jsx)(n.em,{children:"public"}),"."]}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsxs)(n.li,{children:["To avoid recreating the default ",(0,t.jsx)(n.em,{children:"admin"})," role, ",(0,t.jsx)(n.code,{children:"directus-sync"})," uses the CLI user's role as the default ",(0,t.jsx)(n.em,{children:"admin"})," role."]}),"\n",(0,t.jsxs)(n.li,{children:["To avoid recreating the default ",(0,t.jsx)(n.em,{children:"public"})," policy, ",(0,t.jsx)(n.code,{children:"directus-sync"})," uses the first policy found with ",(0,t.jsx)(n.code,{children:"role = null"}),"."]}),"\n",(0,t.jsxs)(n.li,{children:["To avoid recreating the default ",(0,t.jsx)(n.em,{children:"admin"})," policy, ",(0,t.jsx)(n.code,{children:"directus-sync"})," uses the first policy linked to the ",(0,t.jsx)(n.em,{children:"admin"})," role with ",(0,t.jsx)(n.code,{children:"admin_access = true"}),"."]}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"presets",children:"Presets"}),"\n",(0,t.jsx)(n.p,{children:"Global and role based presets are tracked (even the administrator role based presets).\nHowever, the users' presets are not tracked.\nThis is because the users are not tracked and any relation with the users will cause conflicts."}),"\n",(0,t.jsx)(n.h3,{id:"non-tracked-elements-and-ignored-fields",children:"Non-Tracked Elements and Ignored Fields"}),"\n",(0,t.jsx)(n.p,{children:"Elements that are not meant to be tracked, such as user activities and logs, are not affected by the synchronization process. Certain fields are specifically ignored during synchronization because they are not relevant for version control purposes, such as creation dates and the identity of the user who created an entity."}),"\n",(0,t.jsxs)(n.h2,{id:"strengths-of-directus-sync",children:["Strengths of ",(0,t.jsx)(n.code,{children:"directus-sync"})]}),"\n",(0,t.jsxs)(n.p,{children:["The strength of ",(0,t.jsx)(n.code,{children:"directus-sync"})," lies in its ability to maintain consistent and reproducible configurations across multiple environments. It ensures that only the necessary changes are made, avoiding unnecessary recreation of configurations and maintaining the relationships between tracked and non-tracked entities. This selective updating is what makes ",(0,t.jsx)(n.code,{children:"directus-sync"})," a robust tool for managing Directus instances in a team or multi-environment setup."]})]})}function h(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(l,{...e})}):l(e)}},3023:(e,n,s)=>{s.d(n,{R:()=>o,x:()=>c});var i=s(6540);const t={},r=i.createContext(t);function o(e){const n=i.useContext(r);return i.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:o(e.components),i.createElement(r.Provider,{value:n},e.children)}}}]);